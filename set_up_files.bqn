âŸ¨ReplaceAllâŸ© â† â€¢Import â€¢wdpathâˆ¾"/external/bqn-libs/strings.bqn"

yearâ€¿day â† â€¢args


Log â† {msgğ•Šval:
	â€¢Show msgâ€¿val
	val
}

â€¢ParseFloat year
â€¢ParseFloat day


inputs_dir â† â€¢wdpathâˆ¾"/inputs/" âˆ¾ year
sample_dir â† â€¢wdpathâˆ¾ "/samples/" âˆ¾ year
source_dir â† â€¢wdpathâˆ¾ "/src/" âˆ¾ year

inputs_filename â† â€¢wdpathâˆ¾ "/inputs/" âˆ¾ year âˆ¾ "/day" âˆ¾ day âˆ¾ ".txt"
sample_filename â† â€¢wdpathâˆ¾ "/samples/" âˆ¾ year âˆ¾ "/day" âˆ¾ day âˆ¾ ".txt"
source_filename â† â€¢wdpathâˆ¾ "/src/" âˆ¾ year âˆ¾ "/day" âˆ¾ day âˆ¾ ".bqn"

# wrap text with green ascii color:
Green â† {ğ•Štext: "[32m" âˆ¾ text âˆ¾ "[0m"}
# wrap text with grey ascii color:
Grey â† {ğ•Štext: "[90m" âˆ¾ text âˆ¾ "[0m"}
# wrap text with red ascii color:
Red â† {ğ•Štext: "[31m" âˆ¾ text âˆ¾ "[0m"}


StripPrefix â† {prefixğ•Špath:
	Find â† (â‰¢âˆ˜âŠ¢â†‘â·)
	mask â† prefix Find path
	{ğ•Š:
		Ranges â† prefixâŠ¸{(â†•â‰ ğ•¨)âŠ¸+Ë˜ / ğ•¨âŠ¸Find ğ•©}
		{âˆ¾Â´Â¬ âŒˆËË˜ (Ranges ğ•©)=Â¨ < â†•â‰ ğ•©}âŠ¸/path
	}âŸ(âŒˆÂ´ mask)path
}

StripRoot â† â€¢wdpathâŠ¸StripPrefix

SafeCreateDir â† {ğ•Šdir:
	fs â† âŸ¨
		# â€¢file.CreateDirâŠ(â€¢Out "Can't create dir, maybe already exists ? "âˆ¾ â€¢Currenterror) dir,
		{ğ•Š:
			â€¢file.CreateDir dir
			Green "âœ… dir created successfully"
		},
		Grey "- dir already exists!"
	âŸ©
	âŠ¢â—¶ fs â€¢file.Exists dir
}

SafeCreateFile â† {ğ•Šfilepath:
	err_msg â† Red "Can't create file, maybe already exists ? "
	âŠ¢â—¶ âŸ¨
		{ğ•Š:
			filepath â€¢file.Bytes ""
			Green "âœ… file created successfully"
		},
		Grey "- file already exists!"
	âŸ© â€¢file.Exists filepath

}


â€¢Out "Creating input directory: " âˆ¾ StripRoot inputs_dir
â€¢Out SafeCreateDir inputs_dir
â€¢Out "Creating sample directory: " âˆ¾ StripRoot sample_dir
â€¢Out SafeCreateDir sample_dir
â€¢Out "Creating source directory: " âˆ¾ StripRoot source_dir
â€¢Out SafeCreateDir source_dir

â€¢Out "Creating input file: " âˆ¾ StripRoot inputs_filename
â€¢Out SafeCreateFile inputs_filename
â€¢Out "Creating sample file: " âˆ¾ StripRoot sample_filename
â€¢Out SafeCreateFile sample_filename
â€¢Out "Creating source file: " âˆ¾ source_filename
â€¢Out SafeCreateFile source_filename


replacements â† [
	âŸ¨"$YEAR", yearâŸ©
	âŸ¨"$DAY_NUM", dayâŸ©
	âŸ¨"$NAME", "Jules"âŸ©
]

template â† "data â† â€¢file.Lines ""../../samples/$YEAR/day$DAY_NUM.txt""
# data â†© â€¢file.Lines ""../../samples/$YEAR/day$DAY_NUM_alt.txt""
# data â†© â€¢file.Lines ""../../inputs/$YEAR/day$DAY_NUM.txt""

# dyadic show but returns paired args
DShow â† {â€¢Show ğ•¨â€¿ğ•©â‹„ ğ•©}

Log â† {msgğ•Šval:
	â€¢Show (<msg)âˆ¾val
	val
}
RLog â† {msgğ•Šval:
	â€¢Show (msg)â‹ˆval
	val
}

PartOne â† {ğ•Šlines:
	âˆ
}

PartTwo â† {ğ•Šlines:
	âˆ
}

SolutionValidator â† {partâ€¿expectedğ•Šanswer:
	max_length â† expected âŒˆâ—‹(â‰ â€¢Fmt)  answer
	err_msg â† (""
Part ""âˆ¾(â€¢Fmt part)âˆ¾"" is wrong!""âˆ¾""
Expected: ""âˆ¾({Â»âŸ(max_lengthâŠ¸-â‰ ğ•©) max_lengthâŠ¸â†‘ğ•©} â€¢Fmt expected)âˆ¾""
  Actual: ""âˆ¾({Â»âŸ(max_lengthâŠ¸-â‰ ğ•©) max_lengthâŠ¸â†‘ğ•©} â€¢Fmt answer))âˆ¾""
""
	err_msg!(expected= answer)
	â€¢Show ""Correctly solved Part ""âˆ¾(â€¢Fmt part)âˆ¾"": ""âˆ¾(â€¢Fmt answer)
}

AtLeastPartialSolutionValidator â† {partâ€¿expectedğ•Šanswer:
	err_msg â† (""Part ""âˆ¾(â€¢Fmt part)âˆ¾"" is too low! Got instead: ""âˆ¾(â€¢Fmt answer))
	err_msg!(expectedâ‰¥ answer)
	â€¢Show ""Correctly solved Part ""âˆ¾(â€¢Fmt part)âˆ¾"": ""âˆ¾(â€¢Fmt answer)
}

AtMostPartialSolutionValidator â† {partâ€¿expectedğ•Šanswer:
	err_msg â† (""Part ""âˆ¾(â€¢Fmt part)âˆ¾"" is too high! Got instead: ""âˆ¾(â€¢Fmt answer))
	err_msg!(expected< answer)
	â€¢Show ""Correctly solved Part ""âˆ¾(â€¢Fmt part)âˆ¾"": ""âˆ¾(â€¢Fmt answer)
}


""part 1: "" Log PartOne data
# ""part 2: "" Log PartTwo data

# sample
# 1â€¿??? SolutionValidator PartOne data
# input
# 1â€¿??? SolutionValidator PartOne data

# sample
# 2â€¿??? SolutionValidator PartTwo data
# input
# 2â€¿??? SolutionValidator PartTwo data
"

ToRepl â† {ğ•Škeyâ€¿repl:
	[â‹ˆkey,â‹ˆrepl]
}

rendered â† template ReplaceAllÂ´ <Ë˜ ToReplË˜ replacements

â€¢Out "Rendering source file: " âˆ¾ StripRoot source_filename
source_filename â€¢file.Chars rendered
â€¢Out "Done!"

