data â† â€¢file.Lines "../../samples/2020/day7.txt"
# data â†© â€¢file.Lines "../../inputs/2020/day7.txt"

SplitBy â† (+`âˆ˜=âŠ”âŠ¢)

# from bqncrate
FindInString â† {âˆŠâŸœğ•©âŒ¾<ğ•¨}

# remove substring from string
StripSubstring â† {
	full_find â† ğ•¨(â‰¢âˆ˜âŠ¢â†‘â·)ğ•©
	sub_range â† â†•â‰ ğ•¨
	full_range â† â†•â‰ ğ•©

	# characters not in the substring
	mask â† full_range Â¬âˆ˜âˆŠâ¥Š (sub_rangeâŠ¸+)Ë˜ full_find/full_range
	mask/ğ•©
}

# find which character is a digit character
IsNonNumericChar â† {
	nums â† '0'+â†•10
	res â† >Â¬âŒˆË nums= ğ•©
}
# â€¢Show IsNonNumericChar <"99i 2 am 55 years old"

MarkAllowed â† {
	full_find â† ğ•¨(â‰¢âˆ˜âŠ¢â†‘â·)ğ•©
	sub_range â† â†•â‰ ğ•¨
	full_range â† â†•â‰ ğ•©

	# characters not in the substring
	mask â† full_range Â¬âˆ˜âˆŠâ¥Š (sub_rangeâŠ¸+)Ë˜ full_find/full_range
}


ParseAllNumbers â† {
	# 1s where a digit is found
	mask â† (Â¬IsNonNumericChar < ğ•©)
	# start index and end index of each number within the string
	bounds â† âˆ˜â€¿2â¥Š/0 (âˆ¾â‰ âˆ¾Ëœ) mask
	# the start index plus its offset
	join â† (âŠâˆ¾-ËœÂ´)Ë˜bounds
	# each index in the string a digit is at
	idxs â† (<â†•âˆ˜(1âŠ¸âŠ‘)+Ë˜âŠ‘)Ë˜join
	# pull out each char at each index, and parse the whole number
	parsed â†(â€¢ParseFloat âŠâŸœğ•© )Â¨idxs
	parsed
}

ParseBagNew â† {
	# mostly from bqnrate, splits on mask ğ•¨
	Split â† ((0âŠ¸â‰ âˆ˜â‰ Â¨)/âŠ¢)((âŠ¢-Ëœ+`Ã—Â¬)âŠ¸âŠ”)

	# run many precleaners on the input
	preclean â† ğ•© StripSubstringÂ´ âŸ¨".", " bag", " bags"âŸ©

	mask â† Â¬" contain " MarkAllowed preclean
	containerâ€¿raw_childrenâ† (mask) Split preclean

	comma_mask â† Â¬ "," MarkAllowed raw_children
	# â€¢Show comma_mask

	DropLeadingSpace â† ((' '=âŠ)â†“âŠ¢)
	JoinFunc â† ParseAllNumbersâˆ¾(<âˆ˜DropLeadingSpace IsNonNumericCharâˆ˜</âŠ¢)
	children â† (JoinFunc DropLeadingSpace)Â¨ comma_mask Split raw_children
	containerâ€¿children
}


# which bags can eventually contain a shiny gold bag?
PartOne â† {
	bags â† ParseBagNewÂ¨ ğ•©

	ConcatChildren â† {
		containerâ€¿children â† ğ•©
		((<container)âŠ¸âˆ¾âˆ˜<)Â¨ children

	}
	â€¢Show âˆ¾â¥ŠË˜ (>ConcatChildren)Â¨ bags
}


PartOne data

# â€¢Show ParseBagNew âŠ‘ data



# ParseAllNumbers "29 men 1 can, 0 parents"

