data â† â€¢file.Lines "../../samples/2020/day7.txt"
# data â†© â€¢file.Lines "../../inputs/2020/day7.txt"

SplitBy â† (+`âˆ˜=âŠ”âŠ¢)

# from bqncrate
FindInString â† {âˆŠâŸœğ•©âŒ¾<ğ•¨}

# remove substring from string
StripSubstring â† {
	full_find â† ğ•¨(â‰¢âˆ˜âŠ¢â†‘â·)ğ•©
	sub_range â† â†•â‰ ğ•¨
	full_range â† â†•â‰ ğ•©

	# characters not in the substring
	mask â† full_range Â¬âˆ˜âˆŠâ¥Š (sub_rangeâŠ¸+)Ë˜ full_find/full_range
	mask/ğ•©
}

ParseBagLine â† {
	ğ•©

	# line â† "this is my pop tains"
	line â† â€¢Show ((â‰ ğ•©) âŒŠ 100)â†‘ğ•©

	# â€¢Show â‰[line,line]
	to_remove â† " contain "
	mask â† 1âŒˆ(â‰ to_remove)Ã—(to_removeâ·line)
	# â€¢Show (Â¬1â‰ (mask/mask))/line

	bags â† "bags"

	prefix_len â† (/to_removeâ·line)
	suffix_len â† (â‰ to_remove)+prefix_len

	StripCommas â† {
		raw_bag â† ğ•©
		starts_with_comma â†  ','=âŠraw_bag
		without_comma â† (starts_with_comma Ã— 1)â†“raw_bag

		starts_with_space â†  ' '=âŠwithout_comma
		(starts_with_space Ã— 1)â†“without_comma
	}

	# â€¢Show prefix_lenâ†‘line
	raw_contained_bags â† StripCommasÂ¨ ',' SplitBy Â¯1â†“(suffix_len)â†“line
	# â€¢Show "is a 'no other bags' bag?"â€¿(âˆŠâŸœraw_contained_bagsâŒ¾<"no other bags")
	â€¢ShowÂ¨ only_bags â† ("no other bags"âŠ¸â‰¢Â¨/âŠ£)raw_contained_bags
	# â€¢Show "is a 'no other bags' bag?"â€¿("no other bags" FindInString raw_contained_bags)
	# â€¢Show [ "no other bags" ]âˆŠraw_contained_bags

	â€¢Show 50/"-"
	# â€¢Show (+`' '=line)âŠ”line
}

# ParseBagLineÂ¨ data

# data â†© âŸ¨"2 dark red bags", "4 bright white bags","5 muted yellow bags."âŸ©
# â€¢Show data

# Moves numbers to the start of the list
SplitNumbers â† {
	nums â† '0'+â†•10
	res â† >Â¬âŒˆË nums= ğ•©
}


TryToParseBags â† {
	split â† (SplitNumbers <âˆ˜âŠ” >)Ë˜ ğ•©
	#FIXME: contains all the numbers pulled together, so 1 bags and 2 bags
	# becomes 12 bags
	nums â† ((â€¢ParsefloatâŠ0 )âŒ¾âŠ‘)Â¨ split
	StripBags â† " bags"âŠ¸StripSubstring
	StripBagsâˆ˜('.'âŠ¸â‰ /âŠ¢)âŒ¾(1âŠ¸âŠ‘)Â¨ nums
}
res â† TryToParseBags data
# â€¢ShowÂ¨ res

MarkAllowed â† {
	full_find â† ğ•¨(â‰¢âˆ˜âŠ¢â†‘â·)ğ•©
	sub_range â† â†•â‰ ğ•¨
	full_range â† â†•â‰ ğ•©

	# characters not in the substring
	mask â† full_range Â¬âˆ˜âˆŠâ¥Š (sub_rangeâŠ¸+)Ë˜ full_find/full_range
}



ParseBagNew â† {
	# mostly from bqnrate, splits on mask ğ•¨
	Split â† ((0âŠ¸â‰ âˆ˜â‰ Â¨)/âŠ¢)((âŠ¢-Ëœ+`Ã—Â¬)âŠ¸âŠ”)

	# run many precleaners on the input
	preclean â† ğ•© StripSubstringÂ´ âŸ¨".", " bags", " bag"âŸ©

	mask â† Â¬" contain " MarkAllowed preclean
	containerâ€¿raw_childrenâ† (mask) Split preclean

	comma_mask â† Â¬ "," MarkAllowed raw_children
	â€¢Show comma_mask

	DropLeadingSpace â† ((' '=âŠ)â†“âŠ¢)
	children â† DropLeadingSpaceÂ¨ (comma_mask) Split raw_children
	containerâ€¿children
}
â€¢Show ParseBagNew âŠ‘ data



ParseAllNumbers â† {
	# 1s where a digit is found
	mask â† (Â¬SplitNumbers < ğ•©)
	# start index and end index of each number within the string
	bounds â† âˆ˜â€¿2â¥Š/0 (âˆ¾â‰ âˆ¾Ëœ) mask
	# the start index plus its offset
	â€¢Show "join"â€¿(join â† (âŠâˆ¾-ËœÂ´)Ë˜bounds)
	# each index in the string a digit is at
	â€¢Show "idxs"â€¿(idxs â† (<â†•âˆ˜(1âŠ¸âŠ‘)+Ë˜âŠ‘)Ë˜join)
	# pull out each char at each index, and parse the whole number
	parsed â†(â€¢ParseFloat âŠâŸœğ•© )Â¨idxs
	parsed
}
# ParseAllNumbers "29 men 1 can, 0 parents"

# â€¢Show aâ†(â‰ "strings")â†•"lots of strings"
# â€¢Show bâ†("strings")â·"lots of strings"


# â€¢Show aâ†(â‰ "strings")â†•"lots of strings"
# â€¢Show bâ†("strings")â·"lots of strings"

# MakePerson â† {
#  âŸ¨"John", ğ•©, "123 Main St."âŸ©
# }
#
# names â† âŸ¨"Mike", "John", "Sally"âŸ©
# ages â† âŸ¨23, 45, 32âŸ©
# addresses â† âŸ¨"123 Main St.", "456 Elm St.", "789 Oak St."âŸ©
#
# â€¢Show names
# â€¢Show ((<"John")âˆŠnames)âŠages

