data â† â€¢file.Lines "../../samples/2024/day3.txt"
# data â†© â€¢file.Lines "../../samples/2024/day3_alt.txt"
# data â†© â€¢file.Lines "../../inputs/2024/day3.txt"


Log â† {msgğ•Šval:
	â€¢Show msgâ€¿val
	val
}

verbose â† 0
CLog â† {msgğ•Šval:
	{verbose ? â€¢Show msgâ€¿val ; @}
	val
}


mul â† "mul(" #1
digits â† @+48 + â†•10 #2
com â† ',' #3
end â† ')' #4

# â€¢Show [1,2,3,2,4]
# â€¢Show [1,2,2, 2,3,2,2,2,4]


Find â† {charsğ•Šinput:
	charsâ·input âˆ¾ (0Ë˜ (â†• -âŸœ1âˆ˜â‰ )chars)

}

bad â† "mul(3,4]   )"
PartOne â† {ğ•Šlines:
		line â† âŠ‘lines
		"line" Log line
		paddings â† ( (+âŸœ(â†•4))Ë˜ / mul Find line)
		mul_match â† mul Find line
		mul_mask â†   âŒˆË { "mul(" Find line}Ë˜ paddings
		("mul_mask"âŠ¸LogÂ¨) mul_part â† mul_mask+`âŠ¸âŠ”line
		# digm â† 2Ã— digitsâˆŠËœ line
		# comm â† 3Ã—"," Find line
		# endm â† 4Ã—")" Find line
		"end_mask" Log end_mask â† (/ ")"âŠ¸Find)Â¨ mul_mask+`âŠ¸âŠ”line
		"foo" Log foo â† 1+ (((0â‰ â‰ Â¨)âŠ‘Â¨âˆ˜/âŠ¢) end_mask)
		"lengths" Log lengths â† (((0â‰ â‰ Â¨) end_mask )/ mul_part)
		"grabbed" Log grabbed â† foo â†‘Â¨ lengths
		# comb â† (mulm + digm + comm + endm)
    #
		# com2 â† 0â‰  comb
		# both â† âˆ˜â€¿2â¥Š / (Â»âŠ¸< âŒˆ >âŸœÂ« ) com2
		# bot2 â† {ğ•© +<Â·â†•ğ•¨ Â¬ğ•©}ËœÂ´Ë˜ âˆ˜â€¿2â¥Š / (Â»âŠ¸< âŒˆ >âŸœÂ« ) com2
    #
		# bpc2 â† combâŠ¸(âŠËœ)Â¨ bot2
		# pick â† (lineâŠ¸(âŠËœ))Â¨ bot2
		# # "bot2" Log bot2
		# "b+c2" Log comb
		# "pick" Log pick
		# # "bpc2"âŠ¸LogÂ¨ bpc2

		# takes 1 2 3 2 4 and says 'valid'
		# takes 2 3 4 and says 'invalid'
		#
		# TODO: break up adjacent mul() calls
		# TODO: dont grab two right parens in a row
		ValidateMask â† {ğ•Šmask:
			"mask" Log mask
			# starts with 1
			begin â† 1= âŠmask
			# only has 4 1s (FRAGILE!)
			ones â† 4= +Â´1=mask
			# only has 1 4
			four â† 1= +Â´4=mask
			# 2-6 2s
			sixes â† 6â‰¥ +Â´2=mask
			twos â† 2â‰¤ +Â´2=mask
			# ends with 4
			end â† 4= Â¯1âŠmask

			"res" Log [
				âŸ¨"begin", "ones","four","twos", "sixes","end"âŸ©,
				[begin, ones,four,twos, sixes,end]
				]
			ğ•©
		}

		# ValidateMaskÂ¨ bpc2
		â‰ lines
}

PartTwo â† {ğ•Šlines:
 â‰ lines
}

# # input â† [1,1,1,1,2,4,1,1,1,1, 9, 100, 4]
# # "input" Log input
# "input" Log âŠ‘data
#
# input â† ( âŠ‘data)
# mulres â† "mul(" Find input
#
# "mulres" Log mulres
# "group " Log mulres+`âŠ¸âŠ”input
# # "input" Log âŒˆË â·âŸœ(20â†‘ âŠ‘data)Ë˜ "mul(,)"âˆ¾digits

"part 1: " Log PartOne data

# "Part 1 is wrong!"!472= "part 1: " Log PartOne data
# "Part 2 is wrong!"!520= "part 2: " Log PartTwo data
