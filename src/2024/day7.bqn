data â† â€¢file.Lines "../../samples/2024/day7.txt"
# data â†© â€¢file.Lines "../../samples/2024/day7_alt.txt"
data â†© â€¢file.Lines "../../inputs/2024/day7.txt"


# dyadic show but returns paired args
DShow â† {â€¢Show ğ•¨â€¿ğ•©â‹„ ğ•©}

Log â† {msgğ•Šval:
	â€¢Show (<msg)âˆ¾val
	val
}
RLog â† {msgğ•Šval:
	â€¢Show (msg)â‹ˆval
	val
}

PartOne â† {ğ•Šlines:

	Parse â† {ğ•Šline:
		raw_targetâ€¿raw_parts â† (+`':'âŠ¸=Â¨)âŠ¸âŠ”line
		target â† â€¢ParseFloat raw_target
		parts â† â€¢ParseFloatâˆ˜(1âŠ¸â†“)Â¨ 1â†“ (+`' 'âŠ¸=Â¨)âŠ¸âŠ”  1â†“raw_parts

		targetâ€¿parts
	}

	IsCalibrated â† {ğ•Štargetâ€¿parts:
		Apply â† {left_opâ€¿lvğ•Šright_opâ€¿rv:
			res â† lv RightOp rv
			left_opâ€¿res
		}

		ApplyAllFuncs â† {ğ•Šfuncs:

			final_idxâ€¿total â† ApplyÂ´ âŒ½ (funcs âˆ¾ {âŠ¢})âŠ¸(â‹ˆÂ¨)parts
			total
		}

		root_ops â† +â€¿Ã—
		all_ops â† >Ë˜ â¥Š root_opsâˆ¾âŒœâŸ(2-Ëœâ‰ parts) root_ops
		totals â† ApplyAllFuncsË˜ all_ops
		is_valid â† âŒˆÂ´ target=totals
	}

	parsed â† ParseÂ¨ lines
	+Â´âŠ‘Â¨ IsCalibratedÂ¨âŠ¸/ parsed
}

PartTwo â† {ğ•Šlines:
	Parse â† {ğ•Šline:
		raw_targetâ€¿raw_parts â† (+`':'âŠ¸=Â¨)âŠ¸âŠ”line
		target â† â€¢ParseFloat raw_target
		parts â† â€¢ParseFloatâˆ˜(1âŠ¸â†“)Â¨ 1â†“ (+`' 'âŠ¸=Â¨)âŠ¸âŠ”  1â†“raw_parts

		targetâ€¿parts
	}

	IsCalibrated â† {ğ•Štargetâ€¿parts:
		Apply â† {left_opâ€¿lvğ•Šright_opâ€¿rv:
			res â† lv RightOp rv
			left_opâ€¿res
		}

		ApplyAllFuncs â† {ğ•Šfuncs:
			final_idxâ€¿total â† ApplyÂ´ âŒ½ (funcs âˆ¾ {âŠ¢})âŠ¸(â‹ˆÂ¨)parts
			total
		}

		Concat â† {
			left_str â† â€¢Repr ğ•¨
			right_str â† â€¢Repr ğ•©
			â€¢ParseFloat left_strâˆ¾Ëœright_str
		}
		root_ops â† +â€¿Ã—â€¿concat
		all_ops â† >Ë˜ â¥Š root_opsâˆ¾âŒœâŸ(2-Ëœâ‰ parts) root_ops
		totals â† ApplyAllFuncsË˜ all_ops
		is_valid â† âŒˆÂ´ target=totals
	}

	parsed â† ParseÂ¨ lines
	+Â´âŠ‘Â¨ IsCalibratedÂ¨âŠ¸/ parsed
}

SolutionValidator â† {partâ€¿expectedğ•Šanswer:
	err_msg â† ("Part "âˆ¾(â€¢Fmt part)âˆ¾" is wrong! Got instead: "âˆ¾(â€¢Fmt answer))
	err_msg!(expected= answer)
	â€¢Show "Correctly solved Part "âˆ¾(â€¢Fmt part)âˆ¾": "âˆ¾(â€¢Fmt answer)
}

AtLeastPartialSolutionValidator â† {partâ€¿expectedğ•Šanswer:
	err_msg â† ("Part "âˆ¾(â€¢Fmt part)âˆ¾" is too low! Got instead: "âˆ¾(â€¢Fmt answer))
	â€¢Show expectedâ€¿answer
	"expected is < answer" Log expected<answer
	err_msg!(expected< answer)
	â€¢Show "Correctly solved Part "âˆ¾(â€¢Fmt part)âˆ¾": "âˆ¾(â€¢Fmt answer)
}

AtMostPartialSolutionValidator â† {partâ€¿expectedğ•Šanswer:
	err_msg â† ("Part "âˆ¾(â€¢Fmt part)âˆ¾" is too hight! Got instead: "âˆ¾(â€¢Fmt answer))
	â€¢Show expectedâ€¿answer
	"expected is > answer" Log expected>answer
	err_msg!(expected< answer)
	â€¢Show "Correctly solved Part "âˆ¾(â€¢Fmt part)âˆ¾": "âˆ¾(â€¢Fmt answer)
}

# "part 1: " Log PartOne data
# "part 2: " Log PartTwo data

# 1â€¿3749 SolutionValidator PartOne data
# 1â€¿4998764814652 SolutionValidator PartOne data

# 2â€¿11387 SolutionValidator PartTwo data
2â€¿37598910447546 SolutionValidator PartTwo data
