âŸ¨Get, PostâŸ© â† â€¢Import "../external/bqn-curl/curl.bqn"
âŸ¨FromBytesâŸ© â† â€¢Import "../external/bqn-libs/strings.bqn"
âŸ¨Parse, ExportâŸ© â† â€¢Import "../external/bqn-libs/json.bqn"

Pp â† {â€¢Show 100â†‘â€¢Fmtğ•©â‹„ğ•©}
Rr â† { â€¢Show (100âŠ¸â†‘ â€¢Repr ğ•©)â‹„ğ•©}


filename â† "reddit.json"

# âŸ¨contentâŸ© â†Get "https://reddit.com/r/programming.json"
# filename â€¢file.Chars (Export Parse content)

content â†  Parse â€¢file.Bytes filename
listing â†  Parse â€¢file.Bytes filename


KindData â† 1âŠâŠ‘
KindDataChildren â† 1âŠ‘ KindData


Jj â† {â€¢Show (100â†‘ Export ğ•©)â‹„ğ•©}

# use jq to format the json
Jq â† {
	raw_json â† Export ğ•©
	filter â† " | ."
	exitcodeâ€¿stdoutâ€¿stderr â† â€¢SH âŸ¨"jq", "-n", raw_json âˆ¾ filter âŸ©
	â€¢Out 300â†‘ stdout
	ğ•©
}

submissions â† 1â€¿4âŠ‘ 1â€¿1âŠ‘ content
# submissions â† children â† 1âŠ 1âŠ‘ data â† 1âŠ content

# finds the data associated to the field
FindColumn â† {
	column_name â† <ğ•¨
	# â€¢Show "col"â€¿column_nameâ€¿"x"â€¿ğ•©
	column_name ({((â‰ âŠğ•©)â†‘ğ•¨âŠ¸â·)âˆ˜âŠğ•©}/1âŠ¸âŠ) ğ•©
}

# Rr submissions

submission â† 1âŠ‘ KindData 0âŠ submissions
columns_names â† 0âŠ submission

Trim â† {(âˆ¨`âˆ§âˆ¨`âŒ¾âŒ½)' 'â‰ ğ•©}âŠ¸/

short â†  {
	to_find â† âŸ¨"author", "title", "subreddit"âŸ©
	raw_submission â† ğ•©
	(Trimâˆ˜(75âŠ¸â†‘))Â¨ > to_find { ğ•¨FindColumnÂ¨ <  1âŠ‘ KindData ğ•© }Ë˜ raw_submission
}Ë˜ submissions

â€¢ShowË˜   short

â€¢Show "done"
