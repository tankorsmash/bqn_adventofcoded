âŸ¨Get, PostâŸ© â† â€¢Import "../external/bqn-curl/curl.bqn"
âŸ¨FromBytesâŸ© â† â€¢Import "../external/bqn-libs/strings.bqn"
âŸ¨Parse, ExportâŸ© â† â€¢Import "../external/bqn-libs/json.bqn"

Pp â† {â€¢Show 100â†‘â€¢Fmtğ•©â‹„ğ•©}
Rr â† { â€¢Show (100âŠ¸â†‘ â€¢Repr ğ•©)â‹„ğ•©}

Jj â† {â€¢Show (100â†‘ Export ğ•©)â‹„ğ•©}

# use jq to format the json
Jq â† {
	raw_json â† Export ğ•©
	filter â† " | ."
	exitcodeâ€¿stdoutâ€¿stderr â† â€¢SH âŸ¨"jq", "-n", raw_json âˆ¾ filter âŸ©
	â€¢Out 300â†‘ stdout
	ğ•©
}

# finds the data associated to the field
FindColumn â† {
	column_name â† <ğ•¨
	column_name ({((â‰ âŠğ•©)â†‘ğ•¨âŠ¸â·)âˆ˜âŠğ•©}/1âŠ¸âŠ) ğ•©
}

Split â† ((+`âˆ˜=)âŠ”âŠ¢)
SplitRepl â† {
	raw â† ğ•¨((+`âˆ˜=)âŠ”âŠ¢)ğ•©
		(ğ•¨âŠ¸â‰ /âŠ¢)Â¨ raw
}

base_checkboxes â† 0Â¨ â†•1_000_000
# â€¢Show â‰ base_checkboxes

filename2 â† "/mnt/d/Downloads/one-million-checkboxes-data/pre-crash/logs.2024-06-27.txt"
â€¢Show "reading updates"
# log_bytes â† 1_000_000â†‘ â€¢file.MapBytes filename2
log_bytes â† 1_0â†‘ â€¢file.MapBytes filename2
lf â† @+10
updates â† > (1â€¿2âŠ¸âŠ)Â¨ {
	raw_timeâ€¿raw_idxâ€¿raw_bool â† ğ•©
	âŸ¨raw_time, â€¢ParseFloat raw_idx, â€¢ParseFloat raw_boolâŸ©
}Â¨ ((3=â‰ Â¨)/âŠ¢) '|'âŠ¸SplitReplÂ¨ lfâŠ¸SplitRepl log_bytes
â€¢Show "done"

Gather â† {
	idxâ€¿val â† ğ•¨
	ğ•¨
	valâŒ¾(idxâŠ¸âŠ‘)ğ•©
}

rendered â† base_checkboxes GatherË updates
â€¢Show "done rendering"
# â€¢Show ((â‹ˆËœÂ·âŒŠÂ·âˆšâ‰ )â¥ŠâŠ¢)rendered
# â€¢Show 10â†‘updates

# width â† 200
# height â† 200
width â† âˆšâ‰ rendered
height â† âˆšâ‰ rendered

file_headerâ† âˆ¾ âŸ¨
	'P', '6', @+10,
	â€¢Fmt width,' ', â€¢Fmt height,@+10,
	255,@+10
    âŸ©
â€¢Show file_header



times â† (widthÃ—height)
â€¢Show "generating image"â€¿times
# img_data â† [1,0,1]âˆ¾âŸtimes  âŸ¨âŸ©
# img_data â† (timesÃ—3)â¥Š[255,0,0]


# final_image â† file_headerâˆ¾img_data
â€¢Show â‰ rendered
final_image â† file_headerâˆ¾(3âŠ¸Ã—âˆ˜â‰ â¥ŠâŠ¢)rendered
# â€¢Show â‰ final_image
â€¢Show "writing"

filename â† "./src/temp.ppm"

"./temp.ppm" â€¢file.Bytes final_image

# â€¢Show '.'Â¨ 10â€¿20â¥Šâ†• 200
# â€¢Show '1'âŒ¾(0âŠ¸âŠ‘) '0'Â¨  â¥Š ((â‹ˆËœÂ·âŒŠâˆš)â¥Šâ†•)100
# â€¢Show '1'âŒ¾(Â¯1âŠ¸âŠ‘) '0'Â¨  â¥Š ((â‹ˆËœÂ·âŒŠâˆš)â¥Šâ†•)1_000_000


â€¢Show "done writing"


â€¢Show data â† [âŸ¨"data", "test"âŸ©,  âŸ¨"meta", "1234"âŸ©]
fields â† âŸ¨"test", "data"âŸ©
â€¢Show result â† âŠâŸœfieldsâŠ¸âŠË data

# â€¢Show âŸ¨"foo"âŸ©âŠ["foo", "bar", "baz"]

# â€¢Show â€¢SH âŸ¨"feh", filenameâŸ©

# filename â† "../data/securities/2023_aapl.json"
#
# # âŸ¨contentâŸ© â†Get "https://reddit.com/r/programming.json"
# # filename â€¢file.Chars (Export Parse content)
#
# content â†  Parse â€¢file.Bytes filename
#
# resultsIdx â† 4
# dayIdx â† 1
# closeLookup â† 1â€¿3
# â€¢Show  âŠ content
# â€¢Show  dayIdxâŠ‘ 1â€¿resultsIdx âŠ‘ content
# closes â† closeLookupâŠ¸âŠ‘Â¨ 1â€¿resultsIdx âŠ‘ content
# sma7 â† (+Â´Ã·â‰ )Ë˜ (0Â¨â†•7)âˆ¾7â†• closes
# # â€¢ShowÂ¨ (â†•14)â‹ˆÂ¨(14â†‘sma7)
#
# # â€¢Show 14âŠ â‰[closes, 250â†‘sma7]
#
# # â€¢Show (âŠâˆ¾âŠ¢)âŸ4 3â†• â†•10
#
# â€¢Show  {
# 		orig_row â† ğ•©
# 		num_repeats â† 5
# 		Â¯1âŒ½ {("$"âŠ¸âˆ¾Ë˜Â¨orig_row)âˆ¾ğ•©}âŸnum_repeats â‰ orig_row
# 	} [1,2,3,4]
